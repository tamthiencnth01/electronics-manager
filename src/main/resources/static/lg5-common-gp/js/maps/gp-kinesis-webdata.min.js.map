{"version":3,"file":"../gp-kinesis-webdata.min.js","sources":["gp-kinesis-webdata.js"],"sourcesContent":["/* \n *******************************************************************************\n * CSR No.        DATE              AUTHOR             DESCRIPTION\n *******************************************************************************\n *PJTREGULATION-1 2020/05/29        Chowhiwon         규제대응 프로젝트\n *******************************************************************************\n * \n * */\n\nif (document.addEventListener) {\n    document.addEventListener(\"DOMContentLoaded\", function () {\n        document.removeEventListener(\"DOMContentLoaded\", arguments.callee, false);\n        kinesisPutWebData();\n    }, false);\n}\n\n// Internet Explorer\nelse if (document.attachEvent) {\n    document.attachEvent(\"onreadystatechange\", function () {\n        if (document.readyState === \"complete\") {\n            document.detachEvent(\"onreadystatechange\", arguments.callee);\n            kinesisPutWebData();\n        }\n    });\n} //DOM이 모두 로드 되었을 때 function domReady () { //처리할 내용 }\n\nfunction kinesisPutWebData() {\n\tvar classification = getClassificationCode();\n    \n\tvar checkLocale = document.getElementById('kinesislocale').value;\n\tvar cookieLocale = getCookie('KINESIS_COOKIE_LOCALE');\n\tvar dupFlag = 'N';\n\n\tvar cookieArr = []; \n\tif(cookieLocale != ''){\n\t\tcookieArr = cookieLocale.split(',');\n\t}\n    \n\tif(cookieArr.length > 0){\n        for(var i = 0; i < cookieArr.length; i++){\n        \tif(cookieArr[i] == checkLocale){\n                dupFlag = 'Y';\n        \t}\n        }\n\n        if(dupFlag != 'Y'){\n        \tif(cookieArr.length == 0){\n        \t\tcookieLocale = checkLocale\n        \t}else{\n        \t\tcookieLocale += ',';\n        \t    cookieLocale += checkLocale;\n        \t}\n        \tkinesisSetCookie('KINESIS_COOKIE_LOCALE',cookieLocale);\n        }\n\t}else{\n\t\tkinesisSetCookie('KINESIS_COOKIE_LOCALE',document.getElementById('kinesislocale').value);\n\t}\n\t\n    var reqData = {\n        origin: document.getElementById('kinesisorigin').value,\n        locale: document.getElementById('kinesislocale').value,\n        requestedUrl: window.location.href,\n        requestedDomain : window.location.host,\n        status: kinesisGetStatusCode(),\n        cookies: kinesisGetCookie(),\n        requestedDate: kinesisRequestedDate(),\n        utcRequestedDate : kinesisUtcRequestedDate(),\n        buCode: getBuCode(),\n\t\tsuperCategory:getSuperCategory(),\n\t\tcategory:getCategory(),\n\t\tmicrositeFlag:isMicroSite(),\n        referrer: document.referrer,\n        cmpid: kinesisGetCampaignId(),\n        classficationLevel1 : classification.level1,\n        classficationLevel2 : classification.level2,\n        classficationLevel3 : classification.level3,\n        templateFlag: isTemplate() \n    };\n    var reqDataString = JSON.stringify(reqData) + '\\n';\n    var kinesis = new AWS.Kinesis({region: 'ap-northeast-2', accessKeyId: 'AKIA3VZCBYUAU7UIMHR2', secretAccessKey: '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'});\n    var params = {\n        Data: reqDataString, \n        PartitionKey: 'Kine-LGCOM', \n        StreamName: 'KDS-LGE-LEGALCHK-PROD-WEBUSE' \n    };\n\n    kinesis.putRecord(params, function(err, data) {\n        console.log('put result');\n        if (err) {\n            // an error occurred\n            console.log(err, err.stack);\n        } else {\n            // successful response\n            console.log(data);\n        }\n    });\n}\n\nfunction kinesisRequestedDate() {\n    var cd = new Date();\n    var dateStr = cd.getFullYear();\n    dateStr += '-' + ('0' + (cd.getMonth() + 1)).slice(-2);\n    dateStr += '-' + ('0' + cd.getDate()).slice(-2);\n\n    dateStr += ' ' + ('0' + cd.getHours()).slice(-2);\n    dateStr += ':' + ('0' + cd.getMinutes()).slice(-2);\n    dateStr += ':' + ('0' + cd.getSeconds()).slice(-2);\n    dateStr += '.' + ('00' + cd.getMilliseconds()).slice(-3);\n\n    return dateStr;\n}\n\nfunction kinesisUtcRequestedDate() {\n\tvar cd = new Date();\n    var dateStr = cd.getUTCFullYear();\n    dateStr += '-' + ('0' + (cd.getUTCMonth() + 1)).slice(-2);\n    dateStr += '-' + ('0' + cd.getUTCDate()).slice(-2);\n\n    dateStr += ' ' + ('0' + cd.getUTCHours()).slice(-2);\n    dateStr += ':' + ('0' + cd.getUTCMinutes()).slice(-2);\n    dateStr += ':' + ('0' + cd.getUTCSeconds()).slice(-2);\n    dateStr += '.' + ('00' + cd.getUTCMilliseconds()).slice(-3);\n\n    return dateStr;\n}\n\nfunction getBuCode(){\n\tvar serviceType = '';\n\tvar pageType = '';\n\tvar buCode = '';\n\t\n\tif(typeof standardData != 'undefined'){\n\t\tserviceType = standardData.siteType.toLowerCase();\n\t\tpageType = standardData.pageType.toLowerCase();\n\t}else{\n\t\tserviceType = window.location.href.split('/')[4].toLowerCase();\n\t\tpageType = _dl.page_name.page_purpose.toLowerCase();\n\t}\n\t\n\tif(typeof _dl.page_name.bu != 'undefined' && _dl.page_name.bu != ''){\n\t\tif(pageType == 'compare'){\n\t\t\tbuCode = 'compare';\n\t\t}else{\n\t\t\tbuCode = _dl.page_name.bu;\n\t\t}\n\t}else{\n\t\tif('b2b' == serviceType ){\n\t\t\tbuCode = serviceType;\n\t\t}else if('cs' == pageType){\n\t\t\tbuCode = 'support';\n\t\t}else if('home' == pageType){\n\t\t\tbuCode = 'home';\n\t\t}else if('compare' == pageType){\n\t\t\tbuCode = 'compare';\n\t\t}else{\n\t\t\tbuCode = '';\n\t\t}\n\t}\n\t\n\treturn buCode.toUpperCase();\n}\n\nfunction getSuperCategory(){\n\tvar superCategory = _dl.page_name.super_category;\n\tif(null==superCategory||'' ==superCategory){\n\t\tsuperCategory = '';\n\t}\n\treturn superCategory.toUpperCase();\n}\n\nfunction getCategory(){\n\tvar category = _dl.page_name.category;\n\tif(null==category||'' ==category){\n\t\tcategory = '';\n\t}\n\treturn category.toUpperCase();\n}\n\nfunction getClassificationCode(){\n\tvar classificationCode = [];\n\t\n\tif(typeof standardData != 'undefined'){\n\t\tclassificationCode.level1 = standardData.level1;\n\t\tclassificationCode.level2 = standardData.level2;\n\t\tclassificationCode.level3 = standardData.level3;\n\t}else{\n\t\tclassificationCode.level1 = '';\n\t\tclassificationCode.level2 = '';\n\t\tclassificationCode.level3 = '';\n\t}\n\t\n\treturn classificationCode;\n}\n\nfunction isMicroSite(){\n\tvar pagePurpose = _dl.page_name.page_purpose;\n\tif(null==pagePurpose||'' ==pagePurpose){\n\t\tisMicroSite = 'N';\n\t}else{\n\t\tif('microsite'==pagePurpose){\n\t\t\tisMicroSite = 'Y';\n\t\t}else{\n\t\t\tisMicroSite = 'N';\n\t\t}\t\n\t}\n\treturn isMicroSite;\n}\n\nfunction isTemplate(){\n\tisTemplate = 'N';\n\t\n\tif($('body').find('.iw_placeholder').length > 0){\n\t\tisTemplate = 'Y';\n\t}\n\t\n\treturn isTemplate;\n}\n\nfunction kinesisGetCookie(){\n\tvar cookie = {};\n\tvar cookieArray = document.cookie.split(\";\");\n\tvar cookies = new StringBuffer();\n\tfor(var i = 0; i < cookieArray.length; i++){\n\t\tvar cookieTmp = cookieArray[i].split(\"=\");\n\t\tvar cKey = cookieTmp[0].trim();\n\t\tvar cValue = cookieTmp[1].trim();\n\t\tvar filter = /LGCOM_IMPROVEMENTS|LGCOM_SOCIAL_MEDIA|LGCOM_ANALYSIS_OF_SITE|LGCOM_ADVERTISING|eCookieOpenFlag|KINESIS_COOKIE_LOCALE/;\n\t\tif(filter.test(cookieTmp[0]) == true){\n\t\t\tcookies.append(cKey + \"=\" + cValue + \"; \");\n\t\t\tif(i == cookieArray.length -1){\n\t\t\t\tcookies.append(cKey + \"=\" + cValue);\n\t\t\t}\n\t\t}else{\n\t\t\tcookies.append(cKey + \"; \");\n\t\t\tif(i == cookieArray.length -1){\n\t\t\t\tcookies.append(cKey);\n\t\t\t}\n\t\t}\n\t}\n\treturn cookies.toString();\n}\n\nfunction kinesisSetCookie(name, value) {\n\tvar lh = location.host;\n\tvar mydomain = '.lg.com';\n\tif(lh.indexOf('lge.com')>=0) {\n\t\tmydomain = '.lge.com';\n\t} else if(lh.indexOf('localhost')>=0) {\n\t\tmydomain = 'localhost';\n\t}\n\tvar domain = {\n\t\tpath: '/',\n\t\tdomain: mydomain,\n\t\texpires : 365\n\t};\n\t\n\t$.cookie(name, encodeURIComponent(value), domain);\n}\n\nfunction getCookie(name){\n    var cookieValue=null;\n    if(document.cookie){\n        var array=document.cookie.split((escape(cookieName)+'='));\n        if(array.length >= 2){\n            var arraySub=array[1].split(';');\n            cookieValue=unescape(arraySub[0]);\n        }\n    }\n    return cookieValue;\n}\n\nvar StringBuffer = function() {\n    this.buffer = new Array();\n};\nStringBuffer.prototype.append = function(str) {\n    this.buffer[this.buffer.length] = str;\n};\nStringBuffer.prototype.toString = function() {\n    return this.buffer.join(\"\");\n};\n\nString.prototype.trim = function() {\n    return this.replace(/^\\s+|\\s+$/g, \"\");\n}\n\nfunction kinesisGetCampaignId(){\n\tvar params = location.search.substr(location.search.indexOf(\"?\") + 1);\n\tvar cmpid = '';\n\tvar tmpList = [];\n    params = params.split(\"&\");\n\n    for(var j = 0; j < params.length; j++){\n        var temp = params[j].split(\"=\");\n        if(temp[0] == 'cmpid'){\n            if(temp[1] == '?cmpid'){\n               tmpList.push(temp[temp.length-1]);   \n            }else{\n               tmpList.push(temp[1]); \n            }\n            break;\n        }\n    }\n    \n    if(typeof tmpList[0] != 'undefined'){\n    \tcmpid = tmpList[0];\n    }\n    \n    return cmpid;\n}\n\nfunction kinesisGetStatusCode(){\n\tvar status = '';\n\tif(typeof _dl.error_type != 'undefined'){\n\t\tstatus = _dl.error_type.split(':')[0];\n\t}\n\t\n\treturn status;\n}"],"names":["kinesisPutWebData","classification","getClassificationCode","checkLocale","document","getElementById","value","cookieLocale","getCookie","dupFlag","cookieArr","split","length","i","kinesisSetCookie","reqData","origin","locale","requestedUrl","window","location","href","requestedDomain","host","status","kinesisGetStatusCode","cookies","kinesisGetCookie","requestedDate","kinesisRequestedDate","utcRequestedDate","kinesisUtcRequestedDate","buCode","getBuCode","superCategory","getSuperCategory","category","getCategory","micrositeFlag","isMicroSite","referrer","cmpid","kinesisGetCampaignId","classficationLevel1","level1","classficationLevel2","level2","classficationLevel3","level3","templateFlag","isTemplate","params","Data","JSON","stringify","PartitionKey","StreamName","AWS","Kinesis","region","accessKeyId","secretAccessKey","putRecord","err","data","console","log","stack","cd","Date","dateStr","getFullYear","getMonth","slice","getDate","getHours","getMinutes","getSeconds","getMilliseconds","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","serviceType","pageType","standardData","siteType","toLowerCase","_dl","page_name","page_purpose","bu","toUpperCase","super_category","classificationCode","pagePurpose","$","find","cookieArray","cookie","StringBuffer","cookieTmp","cKey","trim","cValue","test","append","toString","name","lh","mydomain","indexOf","domain","path","expires","encodeURIComponent","arraySub","cookieValue","array","escape","cookieName","unescape","addEventListener","removeEventListener","arguments","callee","attachEvent","readyState","detachEvent","this","buffer","Array","tmpList","search","substr","j","temp","push","error_type","prototype","str","join","String","replace"],"mappings":"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"}